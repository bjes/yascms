<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <a class="navbar-brand" href="#">{{ request.sys_config['site_name'] }}</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent"
    aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarContent">
    <ul class="navbar-nav flex-column" data-sm-options="{noMouseOver: true}">
      {% for navbar in navbar_trees recursive %}
        {# 有子選單的類型 #}
        {% if navbar.type == 1 or navbar.type == 4%}
          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbar{{ navbar.aria_name }}Dropdown" role="button" data-toggle="dropdown"
             aria-haspopup="true" aria-expanded="false">
            {% if navbar.icon -%}
              <i class="fas {{ navbar.icon }}"></i> {{ navbar.name }}
            {% else %}
              {{ navbar.name }}
            {%- endif %}
          </a>
            <ul class="dropdown-menu" aria-labelledby="navbar{{ navbar.aria_name }}Dropdown">
              {% if navbar.type == 1 %}
                {{ loop(navbar.descendants) }}
              {% elif navbar.type == 4 %}
                {% if navbar.module_name == 'news' %}
                  {% for each_category in navbar.descendants %}
                    {% if each_category.type == 'news_category' %}
                      <li><a class="dropdown-item" href="{{ request.route_url('news_list', _query={'c': each_category.category_id}) }}">{{ each_category.category_name }}</a></li>
                    {% endif %}
                  {% endfor %}
                  <li class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="{{ request.route_url('news_list') }}">顯示全部</a></li>
                {% endif %}
              {% endif %}
            </ul>
          </li>
        {% elif navbar.type == 2 or navbar.type == 5%}
          <li>
            <a class="dropdown-item" href="#"{% if navbar.is_external %} target="_blank"{% endif %}>
              {% if navbar.icon %}<i class="fas {{ navbar.icon }}"></i> {% endif %}{{ navbar.name }}{% if navbar.is_external %} <i class="fas fa-external-link-alt"></i>{% endif %}
            </a>
          </li>
        {% elif navbar.type == 3 %}
          <li class="dropdown-divider"></li>
        {% endif %}
      {% endfor %}
      <li class="nav-item">
        <a class="nav-link" href="{{ 'login'|route_path }}"><i class="fas fa-sign-in-alt"></i> 登入</a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0">
      <div class="input-group">
        <input class="form-control py-2" type="text" placeholder="搜尋內容" id="search-text">
        <span class="input-group-append bg-white">
          <button class="btn btn-outline-secondary border-0 search-btn-icon" type="button"><i class="fa fa-search"></i></button>
        </span>
      </div>
    </form>
  </div>
</nav>
